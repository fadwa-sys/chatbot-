<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Professeur IA - Syst√®me Solaire</title>
    <style>
        :root { --main: #1a73e8; --bg: #f8f9fa; --text: #202124; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); margin: 0; display: flex; justify-content: center; align-items: center; height: 100vh; }
        #app { width: 95%; max-width: 800px; height: 85vh; background: white; border-radius: 16px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); display: flex; flex-direction: column; overflow: hidden; border: 1px solid #ddd; }
        header { padding: 20px; background: white; border-bottom: 1px solid #eee; text-align: center; }
        header h1 { margin: 0; font-size: 1.4rem; color: var(--main); }
        #chat { flex: 1; overflow-y: auto; padding: 20px; display: flex; flex-direction: column; gap: 15px; background: #ffffff; }
        .bubble { padding: 12px 18px; border-radius: 20px; max-width: 75%; font-size: 15px; line-height: 1.5; }
        .user { background: var(--main); color: white; align-self: flex-end; border-bottom-right-radius: 4px; }
        .bot { background: #f1f3f4; color: var(--text); align-self: flex-start; border-bottom-left-radius: 4px; }
        .input-box { padding: 20px; border-top: 1px solid #eee; display: flex; gap: 10px; background: white; }
        input { flex: 1; padding: 14px; border: 1.5px solid #ddd; border-radius: 30px; outline: none; transition: 0.3s; }
        input:focus { border-color: var(--main); }
        button { background: var(--main); color: white; border: none; padding: 0 25px; border-radius: 30px; cursor: pointer; font-weight: bold; transition: 0.2s; }
        button:hover { opacity: 0.9; transform: translateY(-1px); }
        #status { font-size: 12px; color: #777; padding: 0 20px 10px; display: none; }
    </style>
</head>
<body>

<div id="app">
    <header><h1>üéì Professeur Virtuel Pro</h1></header>
    <div id="chat">
        <div class="bubble bot">Bonjour. Je suis votre assistant acad√©mique propuls√© par Solar Pro 3. Comment puis-je vous aider aujourd'hui ?</div>
    </div>
    <div id="status">Le professeur r√©fl√©chit...</div>
    <div class="input-box">
        <input type="text" id="msgInput" placeholder="Posez votre question...">
        <button onclick="send()">Envoyer</button>
    </div>
</div>

<script>
    const API_KEY = "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";
    const MODEL = "upstage/solar-pro-3:free"; //

    async function send() {
        const input = document.getElementById('msgInput');
        const chat = document.getElementById('chat');
        const status = document.getElementById('status');
        const text = input.value.trim();

        if (!text) return;

        addBubble(text, 'user');
        input.value = "";
        status.style.display = "block";

        try {
            const response = await fetch("https://openrouter.ai/api/v1/chat/completions", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                    "Authorization": "Bearer " + API_KEY
                },
                body: JSON.stringify({
                    model: MODEL,
                    messages: [{ role: "system", content: "Tu es un professeur expert." }, { role: "user", content: text }]
                })
            });

            const data = await response.json();
            status.style.display = "none";

            if (data.choices && data.choices[0]) {
                addBubble(data.choices[0].message.content, 'bot');
            } else {
                // Si l'erreur est encore l√†, on l'affiche proprement pour comprendre
                addBubble("Erreur syst√®me : " + (data.error ? data.error.message : "Inconnue"), 'bot');
            }
        } catch (err) {
            status.style.display = "none";
            addBubble("Probl√®me de connexion au serveur.", 'bot');
        }
    }

    function addBubble(text, type) {
        const div = document.createElement('div');
        div.className = `bubble ${type}`;
        div.innerText = text;
        document.getElementById('chat').appendChild(div);
        document.getElementById('chat').scrollTop = document.getElementById('chat').scrollHeight;
    }

    document.getElementById('msgInput').addEventListener('keypress', (e) => { if(e.key === 'Enter') send(); });
</script>
